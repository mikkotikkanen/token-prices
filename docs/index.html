<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Token Prices - LLM Pricing Data</title>
  <style>
    :root {
      --bg: #1a1a2e;
      --surface: #16213e;
      --primary: #e94560;
      --text: #eee;
      --muted: #888;
      --code-bg: #0f0f1a;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 2rem;
      max-width: 900px;
      margin: 0 auto;
    }
    h1 { color: var(--primary); margin-bottom: 0.5rem; }
    h2 { margin-top: 2.5rem; margin-bottom: 1rem; color: var(--text); border-bottom: 1px solid var(--surface); padding-bottom: 0.5rem; }
    h3 { margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--text); font-size: 1.1em; }
    p { margin-bottom: 1rem; color: var(--muted); }
    a { color: var(--primary); }
    code {
      background: var(--code-bg);
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-size: 0.9em;
    }
    pre {
      background: var(--code-bg);
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      margin: 1rem 0;
    }
    pre code { padding: 0; background: none; }
    .providers {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }
    .provider {
      background: var(--surface);
      padding: 1rem;
      border-radius: 8px;
    }
    .provider h3 { margin: 0 0 0.5rem 0; }
    .provider a { font-size: 0.9em; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      text-align: left;
      padding: 0.5rem;
      border-bottom: 1px solid var(--surface);
    }
    th { color: var(--text); }
    td { color: var(--muted); }
    .intro {
      font-size: 1.1em;
      color: var(--text);
      margin-bottom: 1.5rem;
    }
    .toc {
      background: var(--surface);
      padding: 1rem 1.5rem;
      border-radius: 8px;
      margin: 1.5rem 0;
    }
    .toc ul { margin: 0.5rem 0 0 1.5rem; color: var(--muted); }
    .toc li { margin: 0.3rem 0; }
    .note {
      background: var(--surface);
      padding: 1rem;
      border-radius: 8px;
      border-left: 3px solid var(--primary);
      margin: 1rem 0;
    }
  </style>
</head>
<body>
  <h1>Token Prices</h1>
  <p class="intro">Daily-updated LLM pricing data for OpenAI, Anthropic, Google, and OpenRouter.</p>

  <div class="toc">
    <strong>Contents</strong>
    <ul>
      <li><a href="#overview">Overview</a></li>
      <li><a href="#quick-start">Quick Start</a></li>
      <li><a href="#npm-package">NPM Package</a></li>
      <li><a href="#api-endpoints">API Endpoints</a></li>
      <li><a href="#data-format">Data Format</a></li>
      <li><a href="#stale-data">Stale Data Handling</a></li>
      <li><a href="#advanced">Advanced Usage</a></li>
      <li><a href="#historical">Historical Data</a></li>
      <li><a href="#proposal">For LLM Providers</a></li>
    </ul>
  </div>

  <h2 id="overview">Overview</h2>
  <p>Token Prices provides programmatic access to LLM token pricing. Instead of hardcoding prices or scraping pricing pages yourself, fetch daily-updated JSON or use the npm package.</p>
  <p><strong>Supported providers:</strong> OpenAI, Anthropic, Google, OpenRouter</p>
  <p><strong>Update frequency:</strong> Daily at 00:01 UTC</p>
  <p><strong>Source:</strong> <a href="https://github.com/mikkotikkanen/token-costs">github.com/mikkotikkanen/token-costs</a></p>

  <h2 id="quick-start">Quick Start</h2>

  <h3>Option 1: Direct Fetch (No Dependencies)</h3>
  <p>Fetch JSON directly from this site:</p>
  <pre><code>const response = await fetch('https://mikkotikkanen.github.io/token-costs/api/v1/openai.json');
const data = await response.json();

const gpt4o = data.current.models['gpt-4o'];
console.log(`Input: $${gpt4o.input}/M tokens`);
console.log(`Output: $${gpt4o.output}/M tokens`);</code></pre>

  <h3>Option 2: NPM Package</h3>
  <pre><code>npm install token-costs</code></pre>
  <pre><code>import { getModelPricing, calculateCost } from 'token-costs';

// Get pricing
const result = await getModelPricing('openai', 'gpt-4o');
console.log(result.pricing.input);  // 2.5

// Calculate cost
const cost = await calculateCost('anthropic', 'claude-sonnet-4', {
  inputTokens: 1500,
  outputTokens: 800,
});
console.log(cost.totalCost);  // 0.0165</code></pre>

  <h2 id="npm-package">NPM Package</h2>

  <h3>Installation</h3>
  <pre><code>npm install token-costs</code></pre>

  <h3>PricingClient</h3>
  <p>The main class for fetching and caching pricing data:</p>
  <pre><code>import { PricingClient } from 'token-costs';

const client = new PricingClient();

// Get pricing for a specific model
const result = await client.getModelPricing('openai', 'gpt-4o');
// Returns: { provider, modelId, pricing, date, stale }

// Get all models for a provider
const models = await client.getProviderModels('anthropic');
// Returns: { 'claude-sonnet-4': { input, output, ... }, ... }

// List model IDs
const ids = await client.listModels('google');
// Returns: ['gemini-1.5-pro', 'gemini-1.5-flash', ...]

// Calculate cost
const cost = await client.calculateCost('openai', 'gpt-4o', {
  inputTokens: 1000,
  outputTokens: 500,
  cachedInputTokens: 200,  // optional
});
// Returns: { inputCost, outputCost, totalCost, usedCachedPricing, date, stale }</code></pre>

  <h3>Convenience Functions</h3>
  <p>For quick lookups without creating a client:</p>
  <pre><code>import { getModelPricing, calculateCost } from 'token-costs';

const pricing = await getModelPricing('openai', 'gpt-4o');
const cost = await calculateCost('anthropic', 'claude-sonnet-4', { inputTokens: 1000, outputTokens: 500 });</code></pre>

  <h3>Client Options</h3>
  <pre><code>const client = new PricingClient({
  // Custom base URL (default: GitHub raw content)
  baseUrl: 'https://your-mirror.com/api/v1',

  // Custom fetch function
  fetch: customFetch,

  // Clock offset in milliseconds (if server clock is wrong)
  timeOffsetMs: 2 * 60 * 60 * 1000,  // +2 hours

  // External cache for serverless (Redis, etc.)
  externalCache: {
    get: (key) => redis.get(key),
    set: (key, value) => redis.set(key, value, 'EX', 86400),
  },
});</code></pre>

  <h2 id="stale-data">Stale Data Handling</h2>
  <p>The <code>stale</code> flag indicates if pricing data might be outdated. This happens when:</p>
  <ul style="margin-left: 1.5rem; color: var(--muted); margin-bottom: 1rem;">
    <li><strong>Update window</strong> - Data updates at 00:01 UTC. Between midnight and 00:01, yesterday's data is "current"</li>
    <li><strong>Fetch failure</strong> - If crawlers fail to update, yesterday's data persists</li>
    <li><strong>Clock skew</strong> - Your server's date differs from the data's date</li>
  </ul>

  <pre><code>const result = await getModelPricing('openai', 'gpt-4o');

if (result.stale) {
  // Data date doesn't match today's date
  console.warn(`Using ${result.date} pricing (today is ${new Date().toISOString().split('T')[0]})`);
}

// Stale data is still valid - prices rarely change daily
// Typical staleness is just a few hours around midnight UTC</code></pre>

  <h3>Best Practices</h3>
  <p>For most applications, stale data is acceptable - LLM prices rarely change daily. However, if freshness matters:</p>
  <pre><code>const result = await getModelPricing('openai', 'gpt-4o');

if (result.stale) {
  // Option 1: Use it anyway (recommended for most cases)
  console.log(`Using ${result.date} pricing`);

  // Option 2: Alert but continue
  await sendAlert('Pricing data is stale');

  // Option 3: Refuse to calculate (strict mode)
  throw new Error('Pricing data is stale, aborting');
}

// In cost calculations, staleness is also returned:
const cost = await calculateCost('openai', 'gpt-4o', { inputTokens: 1000, outputTokens: 500 });
console.log(`Cost: $${cost.totalCost} (data from ${cost.date}, stale: ${cost.stale})`);</code></pre>

  <h3>Error Handling</h3>
  <pre><code>import { ClockMismatchError } from 'token-costs';

try {
  const pricing = await getModelPricing('openai', 'gpt-4o');
} catch (error) {
  if (error instanceof ClockMismatchError) {
    // Server clock is significantly off
    console.error(`Clock off by ${error.daysDiff} days`);
  }
}</code></pre>

  <h2 id="api-endpoints">API Endpoints</h2>
  <p>JSON files updated daily at 00:01 UTC:</p>
  <div class="providers">
    <div class="provider">
      <h3>OpenAI</h3>
      <a href="api/v1/openai.json">api/v1/openai.json</a>
    </div>
    <div class="provider">
      <h3>Anthropic</h3>
      <a href="api/v1/anthropic.json">api/v1/anthropic.json</a>
    </div>
    <div class="provider">
      <h3>Google</h3>
      <a href="api/v1/google.json">api/v1/google.json</a>
    </div>
    <div class="provider">
      <h3>OpenRouter</h3>
      <a href="api/v1/openrouter.json">api/v1/openrouter.json</a>
    </div>
  </div>

  <h2 id="data-format">Data Format</h2>

  <h3>API Response Structure</h3>
  <pre><code>{
  "current": {
    "date": "2026-01-12",
    "models": {
      "gpt-4o": {
        "input": 2.5,
        "output": 10,
        "cached": 1.25,
        "context": 128000
      },
      "gpt-4o-mini": {
        "input": 0.15,
        "output": 0.6,
        "context": 128000
      }
    }
  },
  "previous": {
    "date": "2026-01-11",
    "models": { ... }
  }
}</code></pre>

  <h3>Model Fields</h3>
  <table>
    <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    <tr><td><code>input</code></td><td>number</td><td>USD per million input tokens</td></tr>
    <tr><td><code>output</code></td><td>number</td><td>USD per million output tokens</td></tr>
    <tr><td><code>cached</code></td><td>number?</td><td>USD per million cached input tokens</td></tr>
    <tr><td><code>context</code></td><td>number?</td><td>Maximum context window size</td></tr>
    <tr><td><code>maxOutput</code></td><td>number?</td><td>Maximum output tokens</td></tr>
  </table>

  <h3>Why Current and Previous?</h3>
  <div class="note">
    <p>Data updates at 00:01 UTC. If your application fetches at 23:59 UTC and caches, it might have "yesterday's" data when the calendar date changes.</p>
    <p>The dual structure lets you:</p>
    <ul style="margin-left: 1.5rem; color: var(--muted);">
      <li>Detect if your cached data is stale</li>
      <li>Fall back to previous data if current is missing</li>
      <li>Show users when prices last changed</li>
    </ul>
  </div>

  <h2 id="advanced">Advanced Usage</h2>

  <h3>Serverless / Edge Functions</h3>
  <p>In serverless environments, use external cache to avoid refetching on every cold start:</p>
  <pre><code>import { PricingClient } from 'token-costs';
import { Redis } from '@upstash/redis';

const redis = new Redis({ url: process.env.REDIS_URL, token: process.env.REDIS_TOKEN });

const client = new PricingClient({
  externalCache: {
    get: (key) => redis.get(key),
    set: (key, value) => redis.set(key, value, { ex: 86400 }),
  },
});</code></pre>

  <h3>Custom Fetch</h3>
  <p>For environments without global fetch or to add custom headers:</p>
  <pre><code>import { PricingClient } from 'token-costs';
import nodeFetch from 'node-fetch';

const client = new PricingClient({
  fetch: nodeFetch,
});</code></pre>

  <h3>Self-Hosting</h3>
  <p>Mirror the JSON files and point the client to your server:</p>
  <pre><code>const client = new PricingClient({
  baseUrl: 'https://your-cdn.com/token-costs/api/v1',
});</code></pre>

  <h2 id="historical">Historical Data</h2>
  <p>Full price change history is stored in the GitHub repository:</p>
  <p><a href="https://github.com/mikkotikkanen/token-costs/tree/main/history/prices">github.com/mikkotikkanen/token-costs/tree/main/history/prices</a></p>

  <h3>Historical Format</h3>
  <pre><code>{
  "provider": "openai",
  "lastCrawled": "2026-01-12T00:01:00Z",
  "pricingUrl": "https://openai.com/api/pricing/",
  "changes": [
    {
      "date": "2026-01-11",
      "changeType": "added",
      "pricing": {
        "modelId": "gpt-4o",
        "modelName": "GPT-4o",
        "inputPricePerMillion": 2.5,
        "outputPricePerMillion": 10,
        "contextWindow": 128000
      }
    },
    {
      "date": "2026-01-15",
      "changeType": "updated",
      "pricing": { ... },
      "previousPricing": { ... }
    }
  ]
}</code></pre>
  <p>Change types: <code>added</code>, <code>updated</code>, <code>removed</code></p>

  <h2 id="proposal">For LLM Providers</h2>

  <h3>The Problem</h3>
  <p>Every tool that tracks LLM pricing has to scrape your website. This is:</p>
  <ul style="margin-left: 1.5rem; color: var(--muted);">
    <li><strong>Fragile</strong> - breaks when you update your pricing page</li>
    <li><strong>Wasteful</strong> - dozens of tools hitting your site daily</li>
    <li><strong>Inaccurate</strong> - scrapers miss updates or parse incorrectly</li>
  </ul>

  <h3>The Proposal</h3>
  <p>Add a <code>/llm_prices.json</code> file to your website root (like <code>robots.txt</code>):</p>
  <pre><code>{
  "gpt-4o": {
    "input": 2.5,
    "output": 10,
    "cached": 1.25,
    "context": 128000
  },
  "gpt-4o-mini": {
    "input": 0.15,
    "output": 0.6,
    "context": 128000
  }
}</code></pre>

  <h3>Why This Structure</h3>
  <ul style="margin-left: 1.5rem; color: var(--muted);">
    <li><strong>Model ID as key</strong> - matches what developers use in API calls</li>
    <li><strong>Flat object</strong> - simple to parse, no nested hierarchies</li>
    <li><strong>Minimal fields</strong> - only what's needed for cost calculation</li>
    <li><strong>Per-million pricing</strong> - avoids floating point issues with per-token prices</li>
  </ul>

  <h3>Fields</h3>
  <table>
    <tr><th>Field</th><th>Required</th><th>Description</th></tr>
    <tr><td><code>input</code></td><td>Yes</td><td>USD per million input tokens</td></tr>
    <tr><td><code>output</code></td><td>Yes</td><td>USD per million output tokens</td></tr>
    <tr><td><code>cached</code></td><td>No</td><td>USD per million cached input tokens</td></tr>
    <tr><td><code>context</code></td><td>No</td><td>Maximum context window size</td></tr>
  </table>

  <h3>Benefits</h3>
  <ul style="margin-left: 1.5rem; color: var(--muted);">
    <li><strong>One source of truth</strong> - you control the data</li>
    <li><strong>Always accurate</strong> - updated when you change prices</li>
    <li><strong>Zero scraping</strong> - tools fetch a single JSON file</li>
    <li><strong>Tiny payload</strong> - typically under 2KB</li>
  </ul>

  <hr style="margin: 3rem 0; border: none; border-top: 1px solid var(--surface);">
  <p style="text-align: center;"><a href="https://github.com/mikkotikkanen/token-costs">GitHub</a> Â· MIT License</p>
</body>
</html>
